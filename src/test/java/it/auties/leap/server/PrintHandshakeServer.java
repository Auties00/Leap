package it.auties.leap.server;

import java.io.IOException;
import java.net.ServerSocket;

// curl -X GET --resolve api.ipify.org:8080:127.0.0.1 https://api.ipify.org:8080
// 1603010200010001FC0303E2022D6B8FF5E478182A886CB3E3C24CF6A5BE52370F9FC65C193C93F8D310F52028AEA91B1C4B83DF9C511E082C1D4BEF8B329A6A598DB102A129E5FC50DB97C0002A3A3A130113021303C02CC02BCCA9C030C02FCCA8C00AC009C014C013009D009C0035002FC008C012000A010001890A0A000000170000FF01000100000A000C000A4A4A001D001700180019000B000201000010000E000C02683208687474702F312E31000500050100000000000D0018001604030804040105030203080508050501080606010201001200000033002B00294A4A000100001D0020016AF64A16C55D708B7BCE615CD56B6467147F62C8A1857CC61AB3641276A750002D00020101002B000B0A1A1A0304030303020301001B00030200015A5A000100001500D70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
public class PrintHandshakeServer {
    private static final int PORT = 8080;

    public static void main(String[] args) throws IOException {
        try (ServerSocket serverSocket = new ServerSocket(PORT)) {
            System.out.println("Server listening on port " + PORT);
            while (!serverSocket.isClosed()) {
                try (
                        var socket = serverSocket.accept();
                        var inputStream = socket.getInputStream()
                ) {
                    System.out.println("Connected to client: " + socket.getRemoteSocketAddress());
                    int data;
                    while ((data = inputStream.read()) != -1) {
                        System.out.printf("%02X", data);
                    }
                    System.out.println("\nConnection closed.");
                }
            }
        }
    }
}
